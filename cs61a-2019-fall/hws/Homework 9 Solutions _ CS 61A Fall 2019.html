<!DOCTYPE html>
<!-- saved from url=(0030)https://cs61a.org/hw/sol-hw09/ -->
<html lang="en" style="overflow: visible;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="CS 61A: Structure and Interpretation of Computer Programs">
    <meta name="keywords" content="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS">
    <meta name="author" content="John DeNero">
    
    <meta name="viewport" content="width=device-width">

    <script src="./Homework 9 Solutions _ CS 61A Fall 2019_files/jquery.min.js.下载"></script>
    <script src="./Homework 9 Solutions _ CS 61A Fall 2019_files/bootstrap.min.js.下载"></script>
    <script src="./Homework 9 Solutions _ CS 61A Fall 2019_files/highlight.min.js.下载"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="./Homework 9 Solutions _ CS 61A Fall 2019_files/bootstrap.min.css">
    <link rel="stylesheet" href="./Homework 9 Solutions _ CS 61A Fall 2019_files/css">
    <link rel="stylesheet" href="./Homework 9 Solutions _ CS 61A Fall 2019_files/style.css">
    <link rel="stylesheet" href="./Homework 9 Solutions _ CS 61A Fall 2019_files/mono-blue.css">
    <link rel="icon" href="https://cs61a.org/assets/images/favicon.ico">

    

<link rel="stylesheet" type="text/css" href="./Homework 9 Solutions _ CS 61A Fall 2019_files/hw.css">


    <title>
Homework 9 Solutions | CS 61A Fall 2019
</title>
  <script charset="utf-8" src="chrome-extension://jgphnjokjhjlcnnajmfjlacjnjkhleah/js/btype.js"></script><script type="text/javascript" charset="utf-8" src="chrome-extension://jgphnjokjhjlcnnajmfjlacjnjkhleah/js/chrome.js"></script></head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://cs61a.org/">
            <img style="max-width:60px; margin-top: -20px;" class="logo" src="./Homework 9 Solutions _ CS 61A Fall 2019_files/logo.png">
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://cs61a.org/weekly.html">Weekly Schedule</a></li>
            <li><a href="https://cs61a.org/office-hours.html">Office Hours</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="https://cs61a.org/hw/sol-hw09/#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://cs61a.org/instructor.html">Instructors</a></li>
                <li><a href="https://cs61a.org/TAs.html">TAs</a></li>
                <li><a href="https://cs61a.org/tutors.html">Tutors</a></li>
                <li><a href="https://cs61a.org/academic-interns.html">Academic Interns</a></li>
              </ul>
            </li>
            <li><a href="https://cs61a.org/resources.html">Resources</a></li>
            <li><a href="https://cs61a.org/articles/about.html">Syllabus</a></li>
            <li><a href="https://piazza.com/berkeley/fall2019/cs61a" target="_blank">Piazza</a></li>
            <li><a href="https://cs61a.org/extra.html">Extra</a></li>
            <!-- <li><a href="https://scheme.cs61a.org">Scheme</a></li> -->
            <!-- <li><a href="https://sql.cs61a.org">SQL</a></li> -->
            <li><a href="https://code.cs61a.org/">Code</a></li>
            <li><a href="http://tutor.cs61a.org/">Tutor</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class="row">
  <div class="col-md-9 __reader_view_article_wrap_8540350299591692__">
    <header>
      <h1>
        
Homework 9 Solutions

        
        
        <ul class="inline-block list-inline">
          <li><a href="https://cs61a.org/hw/sol-hw09/hw09.zip" class="label label-outline">hw09.zip</a></li>
        </ul>
        
        
      </h1>
    </header>
    
<h2>Solution Files</h2>


    
<h2 id="tail-recursion">Tail Recursion</h2>


<h3 class="question" id="q1">Q1: Replicate</h3>

<p>Below is an implementation of the <code>replicate</code> function, which was seen
in discussion. <code>replicate</code> takes in an element <code>x</code> and an integer <code>n</code>,
and returns a list with <code>x</code> repeated <code>n</code> times.</p>

<pre><code class="hljs objectivec">(define (replicate x n)
	(<span class="hljs-keyword">if</span> (= n <span class="hljs-number">0</span>)
		<span class="hljs-literal">nil</span>
		(cons x (replicate x (- n <span class="hljs-number">1</span>)))))</code></pre>

<p>Update this implementation of <code>replicate</code> to be tail recursive. It should have
identical functionality to the non-tail recursive version.</p>

<blockquote><p>If you're running into an recursion depth exceeded error and you're
using the staff interpreter, it's very likely your solution is not
properly tail recursive.</p>

<p>We test that your solution is tail recursive by calling <code>replicate</code> with
a very large input. If your solution is not tail recursive and does not use
a constant number of frames, it will not be able to successfully run.</p>

<p>You may wish to use the built-in <a href="https://cs61a.org/scheme-builtins.html#append">append</a>
procedure in your solution.</p></blockquote>

<solution>

<pre><code class="hljs cpp">(define (replicate x n)
<div class="sol-highlight">  (define (replicate-helper x n so-far)
    (<span class="hljs-keyword">if</span> (= n <span class="hljs-number">0</span>)
      so-far
      (replicate-helper x (- n <span class="hljs-number">1</span>) (append so-far (<span class="hljs-built_in">list</span> x)))))
  (replicate-helper x n nil)</div>  )</code></pre>

</solution>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q replicate</code></pre>

<h3 class="question" id="q2">Q2: Accumulate</h3>

<p>Fill in the definition for the procedure <code>accumulate</code>, which combines the first
<code>n</code> natural numbers according to the following parameters:</p>

<ol>
  <li><code>combiner</code>: a function of two arguments</li>
  <li><code>start</code>: a number with which to start combining</li>
  <li><code>n</code>: the number of natural numbers to combine</li>
  <li><code>term</code>: a function of one argument that computes the <em>n</em>th term of
  a sequence</li>
</ol>

<p>For example, we can find the product of all the numbers from 1 to 5 by
using the multiplication operator as the <code>combiner</code>, and starting our
product at 1:</p>

<pre><code class="hljs shell"><span class="hljs-meta">scm&gt;</span><span class="bash"> (define (identity x) x)</span>
<span class="hljs-meta">scm&gt;</span><span class="bash"> (accumulate * 1 5 identity)  ; 1 * 1 * 2 * 3 * 4 * 5</span>
120</code></pre>

<p>We can also find the sum of the squares of the same numbers by using the
addition operator as the <code>combiner</code> and <code>square</code> as the <code>term</code>:</p>

<pre><code class="hljs shell"><span class="hljs-meta">scm&gt;</span><span class="bash"> (define (square x) (* x x))</span>
<span class="hljs-meta">scm&gt;</span><span class="bash"> (accumulate + 0 5 square)  ; 0 + 1^2 + 2^2 + 3^2 + 4^2 + 5^2</span>
55
<span class="hljs-meta">scm&gt;</span><span class="bash"> (accumulate + 5 5 square)  ; 5 + 1^2 + 2^2 + 3^2 + 4^2 + 5^2</span>
60</code></pre>

<p>You may assume that the <code>combiner</code> will always be commutative: i.e. the order
of arguments do not matter.</p>

<solution>

<pre><code class="hljs sql">(define (accumulate combiner <span class="hljs-keyword">start</span> n term)
<div class="sol-highlight">  (<span class="hljs-keyword">if</span> (= n <span class="hljs-number">0</span>)
    <span class="hljs-keyword">start</span>
    (accumulate combiner (combiner (term n) <span class="hljs-keyword">start</span>) (- n <span class="hljs-number">1</span>) term))</div>)</code></pre>

</solution>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q accumulate</code></pre>

<!--
<div class="sol-highlight">

<ul>
  <li>Base case: only one item to accumulate, so we return the <code>start</code>ing value</li>
  <li>Recursive call: returns the result of accumulating n-1 numbers,
  beginning with <code>start</code> using <code>term</code>.  All that's missing is the current
  value <code>n</code>.</li>
</ul>

</div>
-->

<h3 class="question" id="q3">Q3: Tail Recursive Accumulate</h3>

<p>Update your implementation of <code>accumulate</code> to be tail recursive.  It
should still pass all the tests for "regular" <code>accumulate</code>!</p>

<p>You may assume that the input <code>combiner</code> and <code>term</code> procedures are
properly tail recursive.</p>

<p>If your implementation for accumulate in the previous question is already
tail recursive, you may simply copy over that solution (replacing <code>accumulate</code> 
with <code>accumulate-tail</code> as appropriate).</p>

<blockquote><p>If you're running into an recursion depth exceeded error and you're
using the staff interpreter, it's very likely your solution is not
properly tail recursive.</p>

<p>We test that your solution is tail recursive by calling <code>accumulate-tail</code> with
a very large input. If your solution is not tail recursive and does not use
a constant number of frames, it will not be able to successfully run.</p></blockquote>

<solution>

<pre><code class="hljs sql">(define (accumulate-tail combiner <span class="hljs-keyword">start</span> n term)
<div class="sol-highlight">  (<span class="hljs-keyword">define</span> (accum-helper x so-<span class="hljs-keyword">far</span>)
    (<span class="hljs-keyword">if</span> (= x <span class="hljs-number">0</span>)
      so-<span class="hljs-keyword">far</span>
      (accum-helper (- x <span class="hljs-number">1</span>) (combiner (term x)))
    ))
  (accum-helper n <span class="hljs-keyword">start</span>))
; ALT solution
(define (accumulate-tail combiner <span class="hljs-keyword">start</span> n term)
  (<span class="hljs-keyword">if</span> (= n <span class="hljs-number">0</span>)
    <span class="hljs-keyword">start</span>
    (accumulate-tail combiner (combiner (term n) <span class="hljs-keyword">start</span>) (- n <span class="hljs-number">1</span>) term))</div>)</code></pre>

</solution>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q accumulate-tail</code></pre>

<div class="sol-highlight">

<p>If we were to implement this iteratively in Python, it might look
something like:</p>

<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">accumulate</span><span class="hljs-params">(combiner, start, n, term)</span>:</span>
    total = start
    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:
        total = combiner(total, term(n))
        n -= <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> total</code></pre>

<p>With that in mind, we can create a helper function in Scheme to help us
track a running total. This will be updated in each recursive call.</p>

<p>The alternative solution simply uses the <code>start</code> value to track all the
values we've used so far, but it effectively functions the same.</p>

</div>


<h2 id="streams">Streams</h2>


<h3 class="question" id="q4">Q4: Multiples of 3</h3>

<p>Define implicitly an infinite stream <code>multiples-of-three</code> that contains
the multiples of 3.</p>

<p>You may use the <code>map-stream</code> function defined below. <code>map-stream</code> takes in
a one-argument function <code>f</code> and a stream <code>s</code> and returns a new stream containing
the elements of <code>s</code> with <code>f</code> applied.</p>

<pre><code class="hljs cpp">(define (<span class="hljs-built_in">map</span>-stream f s)
	(<span class="hljs-keyword">if</span> (null? s)
		nil
		(cons-stream (f (car s)) (<span class="hljs-built_in">map</span>-stream f (cdr-stream s)))))</code></pre>

<p><strong>Do not define any other helper functions.</strong></p>

<solution>

<pre><code class="hljs coffeescript">(define (map-stream f s)
    (<span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span>? s)
    	nil
    	(cons-stream (f (car s)) (map-stream f (cdr-stream s)))))

(define multiples-<span class="hljs-keyword">of</span>-three
<div class="sol-highlight">  (cons-stream <span class="hljs-number">3</span>
    (map-stream (lambda (x) (+ x <span class="hljs-number">3</span>)) multiples-<span class="hljs-keyword">of</span>-three))</div>)</code></pre>

</solution>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q multiples_3</code></pre>

<h3 class="question" id="q5">Q5: NondecreaStream</h3>

<p>Define a function <code>nondecreastream</code>, which takes in a stream of numbers and outputs
  a stream of lists, which overall has the same numbers in the same order, but grouped
  into segments that are non-decreasing.</p>

<p>For example, if the input is a stream containing elements</p>

<pre><code class="hljs">1 2 3 4 1 2 3 4 1 1 1 2 1 1 0 4 3 2 1 ...</code></pre>

<p>the output should contain elements</p>

<pre><code class="hljs">(1 2 3 4) (1 2 3 4) (1 1 1 2) (1 1) (0 4) (3) (2) (1) ...</code></pre>

<p>If the input is an infinite stream, the output should be an infinite stream
  and if the input is finite, the output should also be finite. Even if the input is
  an infinite stream, you can assume that every non-decreasing segment is finite.</p>

<blockquote><p>Hint: avoid any direct recursive calls outside the context of a second part of a call to <code>cons-stream</code>, otherwise your solution won't work for infinite streams!</p></blockquote>

<solution>

<pre><code class="hljs php">(define (nondecreastream s)
<div class="sol-highlight">    (<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span>? s)
        nil
        (begin
         (define (rest) (nondecreastream (cdr-stream s)))
         (<span class="hljs-keyword">if</span> (<span class="hljs-keyword">or</span> (<span class="hljs-keyword">null</span>? (cdr-stream s))
                 (&gt; (car s) (car (cdr-stream s))))
             (cons-stream (<span class="hljs-keyword">list</span> (car s)) (rest))
             (cons-stream (cons (car s) (car (rest)))
                          (cdr-stream (rest)))))))</div></code></pre>

</solution>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q nondecreastream</code></pre>

  </div>

  <div class="col-md-3 sticky">
    <nav class="hidden-print hidden-sm hidden-xs sidebar">
      <ul class="nav nav-stacked noselect">
  <li><a href="https://cs61a.org/hw/sol-hw09/#tail-recursion">Tail Recursion</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/hw/sol-hw09/#q1">Q1: Replicate</a></li>
    <li><a href="https://cs61a.org/hw/sol-hw09/#q2">Q2: Accumulate</a></li>
    <li><a href="https://cs61a.org/hw/sol-hw09/#q3">Q3: Tail Recursive Accumulate</a></li>
  </ul>
  <li><a href="https://cs61a.org/hw/sol-hw09/#streams">Streams</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/hw/sol-hw09/#q4">Q4: Multiples of 3</a></li>
    <li><a href="https://cs61a.org/hw/sol-hw09/#q5">Q5: NondecreaStream</a></li>
  </ul>
</ul>
    </nav>
  </div>
</div>

    </main>

    <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/weekly.html">Weekly Schedule</a></li>
            <li><a href="https://cs61a.org/office-hours.html">Office Hours</a></li>
            <li><a href="https://cs61a.org/staff.html">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/resources.html">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/articles/studying.html">Studying Guide</a></li>
            <li><a href="https://cs61a.org/articles/debugging.html">Debugging Guide</a></li>
            <li><a href="https://cs61a.org/articles/composition.html">Composition Guide</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/articles/about.html">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/articles/about.html#assignments">Assignments</a></li>
            <li><a href="https://cs61a.org/articles/about.html#exams">Exams</a></li>
            <li><a href="https://cs61a.org/articles/about.html#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer>

    

<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    console.log(target);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      // window.scrollTo(0, 0);
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    event.preventDefault();
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      goToId(this.hash);
      document.location.hash = this.hash;
    } else {
      window.open(this.href);
    }
  });
</script>

  
<div id="download_plus_animation"></div></body></html>