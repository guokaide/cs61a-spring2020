<!DOCTYPE html>
<!-- saved from url=(0028)https://cs61a.org/lab/lab13/ -->
<html lang="en" style="overflow: visible;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="CS 61A: Structure and Interpretation of Computer Programs">
    <meta name="keywords" content="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS">
    <meta name="author" content="John DeNero">
    
    <meta name="viewport" content="width=device-width">

    <script src="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/jquery.min.js.下载"></script>
    <script src="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/bootstrap.min.js.下载"></script>
    <script src="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/highlight.min.js.下载"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/bootstrap.min.css">
    <link rel="stylesheet" href="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/css">
    <link rel="stylesheet" href="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/style.css">
    <link rel="stylesheet" href="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/mono-blue.css">
    <link rel="icon" href="https://cs61a.org/assets/images/favicon.ico">

    

    <title>
Lab 13: SQL (Optional) | CS 61A Fall 2019
</title>
  <script charset="utf-8" src="chrome-extension://jgphnjokjhjlcnnajmfjlacjnjkhleah/js/btype.js"></script><script type="text/javascript" charset="utf-8" src="chrome-extension://jgphnjokjhjlcnnajmfjlacjnjkhleah/js/chrome.js"></script></head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://cs61a.org/">
            <img style="max-width:60px; margin-top: -20px;" class="logo" src="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/logo.png">
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://cs61a.org/weekly.html">Weekly Schedule</a></li>
            <li><a href="https://cs61a.org/office-hours.html">Office Hours</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="https://cs61a.org/lab/lab13/#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://cs61a.org/instructor.html">Instructors</a></li>
                <li><a href="https://cs61a.org/TAs.html">TAs</a></li>
                <li><a href="https://cs61a.org/tutors.html">Tutors</a></li>
                <li><a href="https://cs61a.org/academic-interns.html">Academic Interns</a></li>
              </ul>
            </li>
            <li><a href="https://cs61a.org/resources.html">Resources</a></li>
            <li><a href="https://cs61a.org/articles/about.html">Syllabus</a></li>
            <li><a href="https://piazza.com/berkeley/fall2019/cs61a" target="_blank">Piazza</a></li>
            <li><a href="https://cs61a.org/extra.html">Extra</a></li>
            <!-- <li><a href="https://scheme.cs61a.org">Scheme</a></li> -->
            <!-- <li><a href="https://sql.cs61a.org">SQL</a></li> -->
            <li><a href="https://code.cs61a.org/">Code</a></li>
            <li><a href="http://tutor.cs61a.org/">Tutor</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class="row">
  <div class="col-md-9 __reader_view_article_wrap_8895115647076866__">
    <header>
      <h1>
        
Lab 13: SQL (Optional)

        
        
        <ul class="inline-block list-inline">
          <li><a href="https://cs61a.org/lab/lab13/lab13.zip" class="label label-outline">lab13.zip</a></li>
        </ul>
        
        
      </h1>
    </header>
    

<p><i>Due by 11:59pm on Friday, November 29.</i></p>




<h2 id="starter-files">Starter Files</h2>

<p>Download <a href="https://cs61a.org/lab/lab13/lab13.zip">lab13.zip</a>.
Inside the archive, you will find starter files for the questions in this lab,
  along with a copy of the <a href="https://cs61a.org/lab/lab13/ok">Ok</a> autograder.</p>


<h2 id="submission">Submission</h2>

<p>By the end of this lab, you should have submitted the lab with
<code>python3 ok --submit</code>. You may submit more than once before the
deadline; only the final submission will be graded.
Check that you have successfully submitted your code on
<a href="https://okpy.org/">okpy.org</a>.</p>

<p><strong>THIS LAB IS OPTIONAL!!</strong> We encourage you to do it if you have time, but it is not worth any points.</p>



    
<h1 id="sqlite">SQLite</h1>



<h2 id="usage">Usage</h2>


<p>First, check that a file named <code>sqlite_shell.py</code> exists alongside the assignment files.
If you don't see it, or if you encounter problems with it, scroll down to the Troubleshooting
section to see how to download an official precompiled SQLite binary before proceeding.</p>

<p>You can start an interactive SQLite session in your Terminal or Git Bash with
the following command:</p>

<pre><code class="hljs css"><span class="hljs-selector-tag">python3</span> <span class="hljs-selector-tag">sqlite_shell</span><span class="hljs-selector-class">.py</span></code></pre>

<p>While the interpreter is running, you can type <code>.help</code> to see some of the
commands you can run.</p>

<p>To exit out of the SQLite interpreter, type <code>.exit</code> or <code>.quit</code> or press
<code>Ctrl-C</code>.  Remember that if you see <code>...&gt;</code> after pressing enter, you probably
forgot a <code>;</code>.</p>

<p>You can also run all the statements in a <code>.sql</code> file by doing the following:</p>

<ol>
  <li><p>Runs your code and then exits SQLite immediately afterwards.</p>

<pre><code class="hljs css"><span class="hljs-selector-tag">python3</span> <span class="hljs-selector-tag">sqlite_shell</span><span class="hljs-selector-class">.py</span> &lt; <span class="hljs-selector-tag">lab13</span><span class="hljs-selector-class">.sql</span></code></pre></li>
  <li><p>Runs your code and then opens an interactive SQLite session, which is
  similar to running Python code with the interactive <code>-i</code> flag.</p>

<pre><code class="hljs css"><span class="hljs-selector-tag">python3</span> <span class="hljs-selector-tag">sqlite_shell</span><span class="hljs-selector-class">.py</span> <span class="hljs-selector-tag">--init</span> <span class="hljs-selector-tag">lab13</span><span class="hljs-selector-class">.sql</span></code></pre></li>
</ol>


<h1 id="topics">Topics</h1>



<h2 id="sql-aggregation">SQL Aggregation</h2>


<p>Previously, we have been dealing with queries that process one row at a time.
When we join, we make pairwise combinations of all of the rows. When we use
<code>WHERE</code>, we filter out certain rows based on the condition. Alternatively,
applying an <a href="http://www.sqlite.org/lang_aggfunc.html">aggregate function</a>
such as <code>MAX(column)</code> combines the values in multiple rows.</p>

<p>By default, we combine the values of the <em>entire</em> table. For example, if we
wanted to count the number of flights from our <code>flights</code> table, we could use:</p>

<pre><code class="hljs cs">sqlite&gt; <span class="hljs-function">SELECT <span class="hljs-title">COUNT</span>(<span class="hljs-params">*</span>) <span class="hljs-keyword">from</span> FLIGHTS</span>;
<span class="hljs-number">13</span></code></pre>

<p>What if we wanted to group together the values in similar rows and perform the
aggregation operations within those groups? We use a <code>GROUP BY</code> clause.</p>

<p>Here's another example. For each unique departure, collect all the rows having
the same departure airport into a group. Then, select the <code>price</code> column and
apply the <code>MIN</code> aggregation to recover the price of the cheapest departure from
that group. The end result is a table of departure airports and the cheapest
departing flight.</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT departure, MIN(price) FROM flights GROUP BY departure;
AUH<span class="hljs-params">|932
LAS|</span><span class="hljs-number">50</span>
LAX<span class="hljs-params">|89
SEA|</span><span class="hljs-number">32</span>
SFO<span class="hljs-params">|40
SLC|</span><span class="hljs-number">42</span></code></pre>

<p>Just like how we can filter out rows with <code>WHERE</code>, we can also filter out
groups with <code>HAVING</code>. Typically, a <code>HAVING</code> clause should use an aggregation
function. Suppose we want to see all airports with at least two departures:</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT departure FROM flights GROUP BY departure HAVING COUNT(*) &gt;= 2;</span>
LAX
SFO
SLC</code></pre>

<p>Note that the <code>COUNT(*)</code> aggregate just counts the number of rows in each group.
Say we want to count the number of <em>distinct</em> airports instead. Then, we could
use the following query:</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT COUNT(DISTINCT departure) FROM flights;</span>
6</code></pre>

<p>This enumerates all the different departure airports available in our <code>flights</code>
table (in this case: SFO, LAX, AUH, SLC, SEA, and LAS).</p>


<h1 id="questions">Questions</h1>



<h1 id="bank-of-sql">Bank of SQL</h1>


<p>You've just been put in hired as an intern at the bank of SQL, which is using a SQL table to run all of its operations.
As an intern, your job is to write and run various SQL queries to make sure that the bank's normal operations can be
performed (unfortunately, the bank of SQL is a bit behind the times and has not automated this process).</p>

<h3 class="question" id="q1">Q1: Give Interest</h3>

<p>First off, you need to give 2% interest to each account. For example, if an account starts off with $100, it should end
up with $100 + 0.02 * $100 = $102. <em>Make sure to modify the accounts table in place</em>.</p>



<pre><code class="hljs sql"><span class="hljs-comment">-------------------------------------------------------------------------</span>
<span class="hljs-comment">------------------------ Give Interest- ---------------------------------</span>
<span class="hljs-comment">-------------------------------------------------------------------------</span>

<div class="alt solution-1"><span class="hljs-comment">-- replace this line with your solution</span>
</div><div class="solution solution-1"><span class="hljs-keyword">update</span> accounts <span class="hljs-keyword">set</span> amount = amount * (<span class="hljs-number">1.02</span>);</div></code></pre>


        <button id="solution-1" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q give-interest</code></pre>

<h3 class="question" id="q2">Q2: Split Accounts</h3>

<p>Next, your manager tells you that the bank has a new initiative. In this initiative, every account holder will have their account split into two accounts, a savings and a checking account, each with an equal share of the original account's money. For example, if an account has the name "John" and amount 100, the new accounts will have the name "John's Savings Account" and "John's Checking Account", each with amount 50.</p>

<blockquote><p>Hint: you may need to create a temporary table.</p></blockquote>



<pre><code class="hljs sql"><span class="hljs-comment">-------------------------------------------------------------------------</span>
<span class="hljs-comment">------------------------ Split Accounts ---------------------------------</span>
<span class="hljs-comment">-------------------------------------------------------------------------</span>

<div class="alt solution-2"><span class="hljs-comment">-- replace this line with your solution</span>
</div><div class="solution solution-2"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">temporary</span> <span class="hljs-keyword">as</span>
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">name</span> || <span class="hljs-string">"'s Checking account"</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">name</span>, amount * <span class="hljs-number">0.5</span> <span class="hljs-keyword">as</span> amount <span class="hljs-keyword">from</span> accounts <span class="hljs-keyword">union</span>
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">name</span> || <span class="hljs-string">"'s Savings account"</span>         , amount * <span class="hljs-number">0.5</span>           <span class="hljs-keyword">from</span> accounts;

<span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> accounts;
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> accounts <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">temporary</span>;</div></code></pre>


        <button id="solution-2" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q split-accounts</code></pre>

<h3 class="question" id="q3">Q3: Whoops!</h3>

<p>Unfortunately, the Bank of SQL has lost all its customers' money ¯\_(ツ)_/¯. To make sure that the customers don't ask for their money, you need to make sure that all the records are removed! After running this command, the table should not exist.</p>



<pre><code class="hljs sql"><span class="hljs-comment">-------------------------------------------------------------------------</span>
<span class="hljs-comment">-------------------------------- Whoops ---------------------------------</span>
<span class="hljs-comment">-------------------------------------------------------------------------</span>

<div class="alt solution-3"><span class="hljs-comment">-- replace this line with your solution</span>
</div><div class="solution solution-3"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> accounts;</div></code></pre>


        <button id="solution-3" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q whoops</code></pre>


<h1 id="scheme">Scheme</h1>


<h3 class="question" id="q4">Q4: Quine</h3>

<blockquote><p>Note: this question is out of scope, but should be fun!</p></blockquote>

<p>Write a nonempty scheme list that, when evaluated, evaluates to itself.</p>

<p>Precisely, your task is to produce a quine <code>quine</code> that satisfies <code>(and (not (null? quine)) (list? quine) (equal? quine (eval quine)))</code>.</p>



<pre><code class="hljs bash">(define quine
<div class="alt solution-4">    <span class="hljs-string">'your-code-here)
</span></div><div class="solution solution-4"><span class="hljs-string">    ((lambda (x) `(,x '</span>,x)) <span class="hljs-string">'(lambda (x) `(,x '</span>,x))))</div></code></pre>


        <button id="solution-4" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q quine-scheme</code></pre>


<h1 id="cyber-monday">Cyber Monday</h1>


<h3 class="question" id="q5">Q5: Price Check</h3>

<p>After you are full from your Thanksgiving dinner, you realize that you still
need to buy gifts for all your loved ones over the holidays. However, you also
want to spend as little money as possible (you're not cheap, just looking for a
great sale!).</p>

<p>Let's start off by surveying our options. Using the <code>products</code> table, write a
query that creates a table <code>average_prices</code> that lists categories and the
average price of items in the category
(using <a href="https://en.wikipedia.org/wiki/List_price">MSRP</a> as the price).</p>

<p>You should get the following output:</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT category, ROUND(average_price) FROM average_prices;</span>
computer|109.0
games|350.0
phone|90.0</code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> average_prices <span class="hljs-keyword">AS</span>
<div class="alt solution-5">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-5">  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">category</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">category</span>, <span class="hljs-keyword">AVG</span>(msrp) <span class="hljs-keyword">as</span> average_price <span class="hljs-keyword">FROM</span> products <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">category</span>;
  <span class="hljs-comment">-- alternate solution</span>
  <span class="hljs-comment">-- SELECT category, SUM(msrp)/COUNT(*) FROM products GROUP BY category;</span></div></code></pre>


        <button id="solution-5" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q cyber-monday-part1</code></pre>

<explanation>

<p>For each category, we're interested in getting the average MSRP. This happens to
translate quite nicely into a SQL query.</p>

</explanation>
<h3 class="question" id="q6">Q6: The Price is Right</h3>

<p>Now, you want to figure out which stores sell each item in products for the
lowest price. Write a SQL query that uses the <code>inventory</code> table to create a
table <code>lowest_prices</code> that lists items, the stores that sells that item for the
lowest price, and the price that the store sells that item for.</p>

<p>You should expect the following output:</p>

<pre><code class="hljs ruby">sqlite&gt; SELECT * FROM lowest_prices;
Hallmart<span class="hljs-params">|GameStation|</span><span class="hljs-number">298.98</span>
Targive<span class="hljs-params">|QBox|</span><span class="hljs-number">390.98</span>
Targive<span class="hljs-params">|iBook|</span><span class="hljs-number">110.99</span>
RestBuy<span class="hljs-params">|kBook|</span><span class="hljs-number">94.99</span>
Hallmart<span class="hljs-params">|qPhone|</span><span class="hljs-number">85.99</span>
Hallmart<span class="hljs-params">|rPhone|</span><span class="hljs-number">69.99</span>
RestBuy<span class="hljs-params">|uPhone|</span><span class="hljs-number">89.99</span>
RestBuy<span class="hljs-params">|wBook|</span><span class="hljs-number">114.29</span></code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> lowest_prices <span class="hljs-keyword">AS</span>
<div class="alt solution-6">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-6">  <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> inventory <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> item <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">MIN</span>(price);</div></code></pre>


        <button id="solution-6" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q cyber-monday-part2</code></pre>

<explanation>

<p>The inventory table lists all the products on sale at each store.</p>

<p>We're only interested in comparing like products with each other, so it makes
sense to <code>GROUP BY</code> item here. In each group, we only keep the row that has the
minimum price of that group.</p>

</explanation>
<h3 class="question" id="q7">Q7: Bang for your Buck</h3>

<p>You want to make a shopping list by choosing the item that is the best deal
possible for every category. For example, for the "phone" category, the uPhone
is the best deal because the MSRP price of a uPhone divided by its ratings
yields the lowest cost. That means that uPhones cost the lowest money per rating
point out of all of the phones.</p>

<p>Write a query to create a table <code>shopping_list</code> that lists the items that you
want to buy from each category.</p>

<p>After you've figured out which item you want to buy for each category, add
another column that lists the store that sells that item for the lowest price.</p>

<p>You should expect the following output:</p>

<pre><code class="hljs shell"><span class="hljs-meta">sqlite&gt;</span><span class="bash"> SELECT * FROM shopping_list;</span>
GameStation|Hallmart
uPhone|RestBuy
wBook|RestBuy</code></pre>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> shopping_list <span class="hljs-keyword">AS</span>
<div class="alt solution-7">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-7">  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, <span class="hljs-keyword">store</span> <span class="hljs-keyword">FROM</span> products <span class="hljs-keyword">AS</span> p, lowest_prices <span class="hljs-keyword">AS</span> l
    <span class="hljs-keyword">WHERE</span> l.item = p.name
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">category</span> <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">MIN</span>(MSRP/rating);</div></code></pre>


        <button id="solution-7" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<blockquote><p><strong>Hint</strong>: You should use the <code>lowest_prices</code> table you created in the previous
question.</p></blockquote>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q cyber-monday-part3</code></pre>

<div class="solution solution-8">

<p>Instead of doing one big query, we could split this into two steps:</p>

<ol>
  <li>Create a temporary table first that lists out the most cost-efficient product
  for each category (this tells us <strong>what</strong> we want to buy).</li>
  <li>Then, we combine that with the <code>lowest_prices</code> table from before to figure
  out where to buy each item (this tells us <strong>where</strong> we want to buy).</li>
</ol>

<p>Splitting up the work in this way makes a complicated problem statement much
easier to manage.</p>

<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> what(<span class="hljs-keyword">name</span>) <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> products <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">category</span> <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">MIN</span>(MSRP / rating)
);

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> shopping_list <span class="hljs-keyword">AS</span>
  <span class="hljs-keyword">SELECT</span> p.name, l.store <span class="hljs-keyword">FROM</span> what <span class="hljs-keyword">AS</span> p, lowest_prices <span class="hljs-keyword">AS</span> l <span class="hljs-keyword">WHERE</span> p.name = l.item;</code></pre>

<p>If you stare at the solutions long enough, you should be able to convince
yourself that they do the same thing.</p>

</div>
        <button id="solution-8" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        
<h3 class="question" id="q8">Q8: Driving the Cyber Highways</h3>

<p>Using the Mb (megabits) column from the <code>stores</code> table, write a query to
calculate the total amount of bandwidth needed to get everything in your
shopping list.</p>



<pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> total_bandwidth <span class="hljs-keyword">AS</span>
<div class="alt solution-9">  <span class="hljs-keyword">SELECT</span> <span class="hljs-string">"REPLACE THIS LINE WITH YOUR SOLUTION"</span>;
</div><div class="solution solution-9">  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SUM</span>(s.mbs) <span class="hljs-keyword">FROM</span> stores <span class="hljs-keyword">AS</span> s, shopping_list <span class="hljs-keyword">AS</span> sl <span class="hljs-keyword">WHERE</span> s.store = sl.store;</div></code></pre>


        <button id="solution-9" class="btn btn-outline btn-lg solutiontoggle solution" style="display: inline-block;">
        Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>
        

<blockquote><p><strong>Hint</strong>: You should use the <code>shopping_list</code> table you created in the
previous question.</p></blockquote>

<p>Use Ok to test your code:</p><pre><code class="nohighlight">python3 ok -q cyber-monday-part4</code></pre>

<explanation>

<p>This truthfully isn't much of an aggregation question, but it is a nice way to
combine our work from the past couple of problems.</p>

<p>For each of the things we want to purchase, we get the "Mb" cost for getting it.
The last step is summing it all together.</p>

</explanation>


<h1 id="troubleshooting-advanced-sqlite">Troubleshooting/Advanced SQLite</h1>



<h2 id="troubleshooting">Troubleshooting</h2>


<p>Python already comes with a built-in SQLite database engine to process SQL.
However, it doesn't come with a "shell" to let you interact with it from the terminal.
Because of this, until now, you have been using a simplified SQLite shell written by us.
However, you may find the shell is old, buggy, or lacking in features.
In that case, you may want to download and use the official SQLite executable.</p>

<p>If running <code>python3 sqlite_shell.py</code> didn't work, you can download a precompiled sqlite directly by following the following instructions and then use <code>sqlite3</code> and <code>./sqlite3</code> instead of <code>python3 sqlite_shell.py</code> based on which is specified for your platform.</p>


        <button id="toggle-1" class="btn btn-outline btn-lg alwaystoggle toggle" style="display: inline-block;">
        Setup<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-1">
Another way to start using SQLite is to download a precompiled
binary from the <a href="http://www.sqlite.org/download.html">SQLite website</a>.
The latest version of SQLite at the time of writing is 3.28.0, but you
can check for additional updates on the website.

<p>However, before proceeding, please remove (or rename) any SQLite executables
(<code>sqlite3</code>, <code>sqlite_shell.py</code>, and the like)
from the current folder, or they may conflict with the official one you download below.
Similarly, if you wish to switch back later,
please remove or rename the one you downloaded and restore the files you removed.</p>


<h3 id="windows">Windows</h3>


<ol>
  <li>Visit the download page linked above and navigate to the section
  Precompiled Binaries for Windows. Click on the link
  <strong>sqlite-tools-win32-x86-*.zip</strong> to download the binary.</li>
  <li>Unzip the file. There should be a <code>sqlite3.exe</code> file in the
  directory after extraction.</li>
  <li><p>Navigate to the folder containing the <code>sqlite3.exe</code> file and check
  that the version is at least 3.8.3:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> path/to/sqlite</span>
<span class="hljs-meta">$</span><span class="bash"> ./sqlite3 --version</span>
3.12.1 2016-04-08 15:09:49 fe7d3b75fe1bde41511b323925af8ae1b910bc4d</code></pre></li>
</ol>


<h3 id="macos-yosemite-10-10-or-newer">macOS Yosemite (10.10) or newer</h3>


<p>SQLite comes pre-installed. Check that you have a version that's greater than 3.8.3:</p>

<pre><code class="hljs ruby">    $ sqlite3
    SQLite version <span class="hljs-number">3.8</span>.<span class="hljs-number">10.2</span></code></pre>


<h3 id="mac-os-x-mavericks-10-9-or-older">Mac OS X Mavericks (10.9) or older</h3>


<p>SQLite comes pre-installed, but it is the wrong version.</p>

<ol>
  <li>Visit the download page linked above and navigate to the section
  <strong>Precompiled Binaries for Mac OS X (x86)</strong>. Click on
  the link <strong>sqlite-tools-osx-x86-*.zip</strong> to download the
  binary.</li>
  <li>Unzip the file. There should be a <code>sqlite3</code> file in the directory
  after extraction.</li>
  <li><p>Navigate to the folder containing the <code>sqlite3</code> file and check that
  the version is at least 3.8.3:</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> path/to/sqlite</span>
<span class="hljs-meta">$</span><span class="bash"> ./sqlite3 --version</span>
3.12.1 2016-04-08 15:09:49 fe7d3b75fe1bde41511b323925af8ae1b910bc4d</code></pre></li>
</ol>


<h3 id="ubuntu">Ubuntu</h3>


<p>The easiest way to use SQLite on Ubuntu is to install it straight from
the native repositories (the version will be slightly behind the most
recent release):</p>

<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sudo apt install sqlite3</span>
<span class="hljs-meta">$</span><span class="bash"> sqlite3 --version</span>
3.8.6 2014-08-15 11:46:33 9491ba7d738528f168657adb43a198238abde19e</code></pre>

</div>

  </div>

  <div class="col-md-3 sticky">
    <nav class="hidden-print hidden-sm hidden-xs sidebar">
      <ul class="nav nav-stacked noselect">
  <li class=""><a href="https://cs61a.org/lab/lab13/#sqlite">SQLite</a></li>
  <ul class="nav nav-stacked noselect">
    <li class=""><a href="https://cs61a.org/lab/lab13/#usage">Usage</a></li>
  </ul>
  <li class=""><a href="https://cs61a.org/lab/lab13/#topics">Topics</a></li>
  <ul class="nav nav-stacked noselect">
    <li class="active"><a href="https://cs61a.org/lab/lab13/#sql-aggregation">SQL Aggregation</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab13/#questions">Questions</a></li>
  <li><a href="https://cs61a.org/lab/lab13/#bank-of-sql">Bank of SQL</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab13/#q1">Q1: Give Interest</a></li>
    <li><a href="https://cs61a.org/lab/lab13/#q2">Q2: Split Accounts</a></li>
    <li><a href="https://cs61a.org/lab/lab13/#q3">Q3: Whoops!</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab13/#scheme">Scheme</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab13/#q4">Q4: Quine</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab13/#cyber-monday">Cyber Monday</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab13/#q5">Q5: Price Check</a></li>
    <li><a href="https://cs61a.org/lab/lab13/#q6">Q6: The Price is Right</a></li>
    <li><a href="https://cs61a.org/lab/lab13/#q7">Q7: Bang for your Buck</a></li>
    <li><a href="https://cs61a.org/lab/lab13/#q8">Q8: Driving the Cyber Highways</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/lab13/#troubleshooting-advanced-sqlite">Troubleshooting/Advanced SQLite</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/lab13/#troubleshooting">Troubleshooting</a></li>
    <ul class="nav nav-stacked noselect">
      <li><a href="https://cs61a.org/lab/lab13/#windows">Windows</a></li>
      <li><a href="https://cs61a.org/lab/lab13/#macos-yosemite-10-10-or-newer">macOS Yosemite (10.10) or newer</a></li>
      <li><a href="https://cs61a.org/lab/lab13/#mac-os-x-mavericks-10-9-or-older">Mac OS X Mavericks (10.9) or older</a></li>
      <li><a href="https://cs61a.org/lab/lab13/#ubuntu">Ubuntu</a></li>
    </ul>
  </ul>
</ul>
    </nav>
  </div>
</div>

    </main>

    <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/weekly.html">Weekly Schedule</a></li>
            <li><a href="https://cs61a.org/office-hours.html">Office Hours</a></li>
            <li><a href="https://cs61a.org/staff.html">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/resources.html">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/articles/studying.html">Studying Guide</a></li>
            <li><a href="https://cs61a.org/articles/debugging.html">Debugging Guide</a></li>
            <li><a href="https://cs61a.org/articles/composition.html">Composition Guide</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="https://cs61a.org/articles/about.html">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="https://cs61a.org/articles/about.html#assignments">Assignments</a></li>
            <li><a href="https://cs61a.org/articles/about.html#exams">Exams</a></li>
            <li><a href="https://cs61a.org/articles/about.html#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer>

    


<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    console.log(target);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      // window.scrollTo(0, 0);
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    event.preventDefault();
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      goToId(this.hash);
      document.location.hash = this.hash;
    } else {
      window.open(this.href);
    }
  });
</script>


<script type="text/javascript" src="./Lab 13_ SQL (Optional) _ CS 61A Fall 2019_files/config.js.下载"></script>
<script>
/*
This code is duplicated in lab-check-in.html. Doesn't work if we move it to a separate
file because of JQuery document ready concurrency issues.
*/
$(function() {
  var staging_domains = ['staging.cs61a.org', 'solutions.cs61a.org', 'localhost', '127.0.0.1'];
  var host = window.location.hostname;
  var staging = staging_domains.indexOf(host) != -1;
  staging = staging || (host.endsWith('.pullrequests.cs61a.org') && !host.startsWith('last-build.'));

  var after_due_date = new Date(1575187199999) < new Date();
  var before_end_date = new Date() <= new Date(endDate);
  var release_solutions = (staging || after_due_date) && before_end_date;

  if (release_solutions) {
    $('.solutiontoggle').css('display', 'inline-block');
    $('.solutiontoggle').click(function() {
      var solution_id = $(this).attr('id');
      $('div.' + solution_id).slideToggle(600);
    });
  }
  $('.alwaystoggle').css('display', 'inline-block');
  $('.alwaystoggle').click(function() {
    var solution_id = $(this).attr('id');
    $('div.' + solution_id).slideToggle(600);
  });
});
</script>


  
<div id="download_plus_animation"></div></body></html>